<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Default Page</title>
  </head>
  <body>
    <style>
      body {
        margin: 0;
        padding: 0;
        display: flex;
        flex-direction: column;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        min-height: 100vh;
      }

      h1 {
        border-bottom: 1px solid black;
      }

      li{
        margin: 10px 0;
      }

      code {
        font-family: Consolas, Monaco, monospace !important;
      }

      table {
        position: relative;
        width: 100%;
        border-collapse: collapse;
      }

      thead th{
        border: 1px solid black;
      }

      td {
        border: 1px solid black;
      }

      #readme {
        position: relative;
        display: flex;
        flex-direction: column;
        flex-wrap: wrap;
        /* justify-content: center; */
        /* align-items: center; */
        margin-top: 10px;
        width: 600px;
        /* min-width: 300px; */
        /* height: 400px; */
        /* border: 1px solid black; */
      }

      #container {
        
        position: relative;
        display: flex;
        flex-direction: column;
        flex-wrap: wrap;
        justify-content: center;
        align-items: center;
        margin-top: 10px;
        width: 600px;
        /* min-width: 300px; */
        /* height: 400px; */
        border: 1px solid black;
      }

      #result{
        width: 400px;
        margin: 10px;
        box-sizing: border-box;
        border: 1px solid black;
      }
    </style>
    <div id="readme">
      <h1>How to get started</h1>

      <ol>
        <li>
          If you want to run this project locally, please ensure that <a target="_blank" href="https://nodejs.org/">Node.js</a> is installed in your computer and follow the instruction below. Otherwise you can just skip to <a href="#request-format"> Request Format</a>.
         
        </li>
        <li>
          Clone the repository:
          <code
            >git clone https://github.com/neverIand/http-arithmetic.git</code
          >
          and then <code>cd http-arithmetic</code>
        </li>
        <li>run <code>npm install</code> under the project directory</li>
        <li>run <code>npm start</code></li>
        <li>The application is now running on port 3000.</li>
      </ol>

      <h1 id="request-format">Request format</h1>

      <h2>Base URL</h2>

      <p>Local: <code>http://localhost:3000</code></p>

      <p>Remote: <code>http://tangyizhe.com:3000</code></p>

      <h2>Endpoints for GET request</h2>

      <table>
        <thead>
          <tr>
            <th>Endpoints</th>
            <th>Description</th>
            <th>Compulsory parameters</th>
            <th>URL examples</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>/add</td>
            <td>Returns the sum of two numbers</td>
            <td rowspan="4">number1, number2</td>
            <td>http://localhost:3000/add/1/2</td>
          </tr>
          <tr>
            <td>/subtract</td>
            <td>Returns the difference between two numbers</td>
            <td>http://localhost:3000/subtract/5/3</td>
          </tr>
          <tr>
            <td>/multiply</td>
            <td>Returns the product of two numbers</td>
            <td>http://localhost:3000/multiply/6/7</td>
          </tr>
          <tr>
            <td>/subtract</td>
            <td>
              Returns the quotient of two numbers <br />(number1 / number2)
            </td>
            <td>http://localhost:3000/add/1/2</td>
          </tr>
        </tbody>
      </table>

      <h2>Parameters for POST request</h2>

      <table>
        <thead>
          <tr>
            <th>Parameter</th>
            <th>Values</th>
            <th>Examples</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>operation</td>
            <td>add, subtract, multiply, divide</td>
            <td rowspan="2">{'operation': 'add', 'arguments': [1, 2]}</td>
          </tr>
          <tr>
            <td>arguments</td>
            <td>[number1 number2]</td>
          </tr>
        </tbody>
      </table>

      <h2>Errors</h2>

      <p>
        By deault, HTTP status code won't be displayed, which means status code
        for all normal response is 200. Otherwise, for any error, you will get
        the response with status code and error message in json format. Example:
      </p>

      <p>

      
      <pre>
        <code>
{
  "status": 500
  "message": "Internal Server Error: Zero division"
}
        </code>
      </pre>
    </p>
    </div>

    <div id="container" style="display: none;">
      <h3>Result:</h3>
      <div id="result"></div>
      <form action="" method="post">
        <input type="number" name="number1" value="0" id="number1" />

        <!-- <p>Operation:</p> -->
        <select name="operation" id="operation">
          <option value="add">add</option>
          <option value="subtract">subtract</option>
          <option value="multiply">multiply</option>
          <option value="divide" selected>divide</option>
        </select>
        <input type="number" name="number2" value="0" id="number2" />
      </form>
      <button id="button">POST</button>
      
    </div>

    <script src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
    <script>
      const url = 'http://tangyizhe.com:3000'
      const localhost = 'http://localhost:3000'

      $('#button').click(function () {
        let operation = $('#operation').val()
        let nums = [$('#number1').val(), $('#number2').val()]
        let targetData = { operation: operation, arguments: nums }
        console.log(`data: ${JSON.stringify(targetData)}`)

        $.ajax({
          contentType: 'application/json;charset=utf-8',
          url: url,
          method: 'post',
          data: JSON.stringify(targetData),
          // dataType: 'JSON',
          error: function (res) {
            //console.log('error: '+JSON.stringify(res))
            console.log(res.responseText)
            $('#result').html('<p>' + res.responseText + '</p>')
          },
          success: function (res) {
            console.log(res)

            $('#result').html('<p>' + res.result + '</p>')
          },
        })
      })
    </script>
  </body>
</html>
